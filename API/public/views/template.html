<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans&display=swap"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TAX INVOICE - {{company.name}}</title>
  </head>
  <body
    style="
      margin: 0;
      padding: 0;
      background: #ffffff;
      color: #1f2937;
      font-family: Arial, Helvetica, sans-serif;
    "
  >
    <!-- Page container -->
    <div style="max-width: 64rem; margin: 0 auto; padding: 10mm">
      <!-- Header (kept as flex; if issues, see table fallback below) -->
      <div
        style="
          width: 100%;
          border-bottom: 4px solid #1a3b5d;
          padding-bottom: 12px;
          margin-bottom: 12px;
        "
      >
        <table style="width: 100%; border-collapse: collapse">
          <tr>
            <!-- Left: Logo + Provider Info -->
            <td style="width: 60%; vertical-align: middle; height: 100%">
              <div
                style="
                  display: flex;
                  align-items: center; /* centers content vertically */
                  justify-content: flex-start; /* space between items if needed */
                  gap: 12px; /* spacing between logo and info */
                  height: 100%; /* makes it fill the td height */
                "
              >
                <!-- Logo -->
                <img
                  src="data:image/png;base64,{{company.logo}}"
                  alt="Logo"
                  style="height: 64px; width: auto"
                />

                <!-- Provider Info -->
                <div
                  style="
                    display: flex;
                    flex-direction: column;
                    justify-content: center;
                  "
                >
                  <h1
                    style="
                      font-size: 14px;
                      font-weight: 800;
                      color: #1a3b5d;
                      text-transform: uppercase;
                      margin: 0;
                    "
                  >
                    {{company.name}}
                  </h1>
                  <div style="font-size: 10px; line-height: 1.4">
                    <span style="font-weight: 600">GSTIN:</span>
                    <span
                      style="font-family: Consolas, Menlo, Monaco, monospace"
                    >
                      {{company.gstin}}
                    </span>
                  </div>
                </div>
              </div>
            </td>

            <!-- Right: Invoice Info -->
            <td style="vertical-align: top; width: 40%; text-align: right">
              <div
                style="
                  font-size: 22px;
                  font-weight: 800;
                  color: #1a3b5d;
                  letter-spacing: 0.02em;
                  text-transform: uppercase;
                "
              >
                Tax Invoice
              </div>
              <div style="font-size: 10px; margin-top: 4px">
                <span style="font-weight: 600">Tax Invoice No:</span>
                <span style="font-family: Consolas, Menlo, Monaco, monospace">
                  {{invoice.taxNo}}
                </span>
              </div>
              <div style="font-size: 10px; margin-top: 2px">
                <span style="font-weight: 600">Tax Invoice date:</span>
                <span style="font-family: Consolas, Menlo, Monaco, monospace">
                  {{invoice.taxDate}}
                </span>
              </div>
              <div style="font-size: 10px; margin-top: 6px">
                <span style="font-weight: 600">State Code</span>
                <span
                  style="
                    display: inline-block;
                    border: 1px solid #d1d5db;
                    border-radius: 6px;
                    padding: 2px 8px;
                    margin-left: 6px;
                    font-family: Consolas, Menlo, Monaco, monospace;
                    background: #fafafa;
                  "
                >
                  {{invoice.stateCode}}
                </span>
                <span style="margin-left: 8px">
                  | State: {{invoice.stateName}}
                </span>
              </div>
            </td>
          </tr>
        </table>
      </div>

      <!-- Parties row using CSS Grid for equal height -->
      <div
        style="
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 8px;
          margin-top: 14px;
        "
      >
        <!-- Receiver -->
        <div
          style="
            display: flex;
            flex-direction: column;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
          "
        >
          <div
            style="
              background: #f7fafc;
              border-bottom: 1px solid #d1d5db;
              padding: 10px 12px;
              color: #1a3b5d;
              font-weight: 200;
              font-size: 12px;
            "
          >
            Details Of Receiver
          </div>
          <div
            style="
              padding: 12px;
              display: grid;
              grid-template-columns: 30% 70%;
              gap: 6px 14px;
              font-size: 10px;
              line-height: 1.45;
              flex: 1;
            "
          >
            <div style="font-weight: 600; color: #374151">Name</div>
            <div>{{client.name}}</div>
            <div style="font-weight: 600; color: #374151">GSTIN</div>
            <div style="font-family: Consolas, Menlo, Monaco, monospace">
              {{client.gstin}}
            </div>
            <div style="font-weight: 600; color: #374151">Address</div>
            <div>{{client.address}}</div>
            <div style="font-weight: 600; color: #374151">State</div>
            <div>{{client.state}}</div>
          </div>
        </div>

        <!-- Provider -->
        <div
          style="
            display: flex;
            flex-direction: column;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
          "
        >
          <div
            style="
              background: #f7fafc;
              border-bottom: 1px solid #d1d5db;
              padding: 10px 12px;
              color: #1a3b5d;
              font-weight: 200;
              font-size: 12px;
            "
          >
            Details Of Service Provider
          </div>
          <div
            style="
              padding: 12px;
              display: grid;
              grid-template-columns: 30% 70%;
              gap: 6px 14px;
              font-size: 10px;
              line-height: 1.45;
              flex: 1;
            "
          >
            <div style="font-weight: 600; color: #374151">Name</div>
            <div>{{company.name}}</div>
            <div style="font-weight: 600; color: #374151">GSTIN</div>
            <div style="font-family: Consolas, Menlo, Monaco, monospace">
              {{company.gstin}}
            </div>
            <div style="font-weight: 600; color: #374151">Address</div>
            <div>{{company.address}}</div>
            <div style="font-weight: 600; color: #374151">State</div>
            <div>{{company.state}}</div>
          </div>
        </div>
      </div>

      <!-- HR divider similar to top -->
      <div style="border-bottom: 4px solid #1a3b5d; margin-top: 14px"></div>

      <!-- Ledger -->
      <div
        style="
          margin-top: 12px;
          border: 1px solid #d1d5db;
          border-radius: 8px;
          overflow: hidden;
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        "
      >
        <table
          style="width: 100%; border-collapse: collapse; table-layout: fixed"
        >
          <thead>
            <tr style="background: #f7fafc; border-bottom: 1px solid #d1d5db">
              <th
                style="
                  text-align: left;
                  padding: 8px;
                  font-size: 10px;
                  font-weight: 600;
                  width: 50px;
                "
              >
                Sr No
              </th>
              <th
                style="
                  text-align: left;
                  padding: 8px;
                  font-size: 10px;
                  font-weight: 600;
                  width: 100px;
                "
              >
                Date
              </th>
              <th
                style="
                  text-align: left;
                  padding: 8px;
                  font-size: 10px;
                  font-weight: 600;
                  width: 100px;
                "
              >
                Vehicle No.
              </th>
              <th
                style="
                  text-align: left;
                  padding: 8px;
                  font-size: 10px;
                  font-weight: 600;
                "
              >
                Particulars
              </th>
              <th
                style="
                  text-align: right;
                  padding: 8px;
                  font-size: 10px;
                  font-weight: 600;
                  width: 100px;
                "
              >
                Amount (Rs.)
              </th>
            </tr>
          </thead>
          <tbody>
            {{#each invoiceItems}}
            <tr style="border-bottom: 1px solid #e5e7eb; font-size: 10px">
              <td style="padding: 6px 8px; text-align: center">{{this.sr}}</td>
              <td
                style="
                  padding: 6px 8px;
                  font-family: Consolas, Menlo, Monaco, monospace;
                "
              >
                {{this.date}}
              </td>
              <td
                style="
                  padding: 6px 8px;
                  font-family: Consolas, Menlo, Monaco, monospace;
                "
              >
                {{this.vehicleNo}}
              </td>
              <td style="padding: 6px 8px">{{this.particulars}}</td>
              <td
                style="
                  padding: 6px 8px;
                  text-align: right;
                  font-family: Consolas, Menlo, Monaco, monospace;
                "
              >
                <i
                  class="fa-solid fa-indian-rupee-sign"
                  style="margin-right: 2px"
                ></i>
                {{this.amount}}
              </td>
            </tr>
            {{/each}}
          </tbody>
        </table>
      </div>

      <!-- Bank + Total row (table layout: two cells) -->
      <div
        style="
          display: table;
          width: 100%;
          table-layout: fixed;
          margin-top: 12px;
        "
      >
        <!-- Bank -->
        <div
          style="
            display: table-cell;
            vertical-align: top;
            width: 50%;
            padding-right: 1mm !important;
            height: 150px; /* fixed height */
          "
        >
          <div
            style="
              height: 100%; /* fill parent cell */
              box-sizing: border-box; /* include padding in height */
              display: flex;
              flex-direction: column; /* header + body layout */
              border: 1px solid #d1d5db;
              border-radius: 8px;
              overflow: hidden;
              box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
            "
          >
            <div
              style="
                background: #f7fafc;
                border-bottom: 1px solid #d1d5db;
                padding: 10px 12px;
                color: #1a3b5d;
                font-weight: 200;
                font-size: 12px;
              "
            >
              Bank Details
            </div>

            <!-- content area fills remaining space -->
            <div
              style="
                padding: 12px;
                display: grid;
                grid-template-columns: 20% 80%;
                gap: 6px 14px;
                font-size: 10px;
                line-height: 1.2;
                flex: 1; /* <-- makes this grow to match height */
                overflow: hidden; /* hide overflow or use auto if you want scroll */
              "
            >
              <div style="font-weight: 600">Bank Name</div>
              <div>{{company.name}}</div>
              <div style="font-weight: 600">Branch</div>
              <div>{{company.branch}}</div>
              <div style="font-weight: 600">Ac No</div>
              <div style="font-family: Consolas, Menlo, Monaco, monospace">
                {{company.account}}
              </div>
              <div style="font-weight: 600">IFSC</div>
              <div style="font-family: Consolas, Menlo, Monaco, monospace">
                {{company.ifsc}}
              </div>
            </div>
          </div>
        </div>

        <!-- Total -->
        <div
          style="
            display: table-cell;
            vertical-align: top;
            width: 50%;
            height: 150px; /* same fixed height */
            padding-left: 1mm !important;
          "
        >
          <div
            style="
              height: 100%; /* fill parent cell */
              box-sizing: border-box;
              display: flex;
              flex-direction: column;
              border: 1px solid #d1d5db;
              border-radius: 8px;
              overflow: hidden;
              box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
            "
          >
            <div
              style="
                background: #f7fafc;
                border-bottom: 1px solid #d1d5db;
                padding: 10px 12px;
                color: #1a3b5d;
                font-weight: 200;
                font-size: 12px;
              "
            >
              Total
            </div>

            <div
              style="
                padding: 12px;
                flex: 1;
                display: flex;
                flex-direction: column;
                box-sizing: border-box;
                overflow: hidden;
              "
            >
              <div style="display: table; width: 100%; table-layout: fixed">
                <div style="display: table-row">
                  <div
                    style="
                      display: table-cell;
                      padding: 4px 0;
                      font-size: 10px;
                      font-weight: 600;
                      color: #374151;
                    "
                  >
                    Subtotal
                  </div>
                  <div
                    style="
                      display: table-cell;
                      padding: 4px 0;
                      font-size: 10px;
                      text-align: right;
                      font-family: Consolas, Menlo, Monaco, monospace;
                    "
                  >
                    <i
                      class="fa-solid fa-indian-rupee-sign"
                      style="margin-right: 2px"
                    ></i>
                    {{totals.subtotal}}
                  </div>
                </div>

                <div style="display: table-row">
                  <div
                    style="
                      display: table-cell;
                      padding: 4px 0;
                      font-size: 10px;
                      font-weight: 600;
                      color: #374151;
                    "
                  >
                    CGST {{totals.cgstRate}}%
                  </div>
                  <div
                    style="
                      display: table-cell;
                      padding: 4px 0;
                      font-size: 10px;
                      text-align: right;
                      font-family: Consolas, Menlo, Monaco, monospace;
                    "
                  >
                    <i
                      class="fa-solid fa-indian-rupee-sign"
                      style="margin-right: 2px"
                    ></i>
                    {{totals.cgstAmount}}
                  </div>
                </div>

                <div style="display: table-row">
                  <div
                    style="
                      display: table-cell;
                      padding: 4px 0;
                      font-size: 10px;
                      font-weight: 600;
                      color: #374151;
                    "
                  >
                    SGST {{totals.sgstRate}}%
                  </div>
                  <div
                    style="
                      display: table-cell;
                      padding: 4px 0;
                      font-size: 10px;
                      text-align: right;
                      font-family: Consolas, Menlo, Monaco, monospace;
                    "
                  >
                    <i
                      class="fa-solid fa-indian-rupee-sign"
                      style="margin-right: 2px"
                    ></i>
                    {{totals.sgst}}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Amount in Words (full width) -->
      <div
        style="
          margin-top: 12px;
          border: 1px solid #d1d5db;
          border-radius: 8px;
          overflow: hidden;
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        "
      >
        <div
          style="
            background: #f7fafc;
            border-bottom: 1px solid #d1d5db;
            padding: 10px 12px;
            color: #1a3b5d;
            font-weight: 200;
            font-size: 12px;
          "
        >
          <div
            style="
              display: table-cell;
              padding: 4px 0;
              font-size: 16px;
              font-weight: 800;
            "
          >
            Billing Total Amount
          </div>
        </div>
        <div style="padding: 12px; font-size: 10px">
          <div style="display: table-row; color: #1a3b5d">
            <div
              style="
                display: table-cell;
                padding: 4px 0;
                font-size: 16px;
                font-weight: 800;
                text-align: right;
                font-family: Consolas, Menlo, Monaco, monospace;
              "
            >
              <i
                class="fa-solid fa-indian-rupee-sign"
                style="margin-right: 2px"
              ></i>
              {{totals.grand}}
            </div>
          </div>
          <span style="font-weight: 200; color: #374151; margin-top: 5px"
            >({{totals.inWords}})
          </span>
        </div>
      </div>

      <!-- Signatures row (table layout: two cells) -->
      <div
        style="
          display: table;
          width: 100%;
          table-layout: fixed;
          margin-top: 16px;
        "
      >
        <!-- Left side -->
        <div
          style="
            display: table-cell;
            vertical-align: bottom;
            width: 50%;
            padding-right: 1mm !important;
          "
        >
          <div
            style="
              height: 68px;
              border: 1px dashed #d1d5db;
              border-radius: 8px;
              color: #b3bbcc;
              font-size: 10px;
              text-align: center;
              line-height: 68px; /* ✅ centers vertically */
            "
          >
            Received.
          </div>
        </div>

        <!-- Right side -->
        <div
          style="
            display: table-cell;
            vertical-align: bottom;
            width: 50%;
            text-align: right;
            padding-left: 1mm !important;
          "
        >
          <div
            style="
              height: 68px;
              border: 1px dashed #d1d5db;
              border-radius: 8px;
              color: #b3bbcc;
              font-size: 10px;
              text-align: center;
              line-height: 68px; /* ✅ centers vertically */
            "
          >
            For, {{company.name}}
          </div>
        </div>
      </div>
    </div>

    <!-- Invoice main content ends here -->
    <!-- Business Info / Marketing Footer -->
    <div
      style="text-align: center; font-size: 5px; color: #444; padding: 20px 0"
    >
      <div
        style="
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 10px;
        "
      >
        <img
          src="data:image/png;base64,{{business.logo}}"
          alt="PayInvoFlow Logo"
          style="height: 18px; width: auto"
        />

        <div style="text-align: left">
          <div style="font-weight: bold; color: #1a3b5d">
            <span style="text-transform: uppercase">Generated by</span>
            {{business.name}}
          </div>
          <div style="color: #555">
            {{business.email}} | {{business.contact}}
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
